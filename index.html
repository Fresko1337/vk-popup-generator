<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>VK Popuper</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
   	<script src="js/html2canvas.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
    	function SaveImage(){
    		html2canvas(document.getElementById('message_body'), {
  				allowTaint:true,
  				taintTest:false,		
  				background: undefined,
  				letterRendering: true,
	  			onrendered: function(canvas) {
	    			document.appendChild(canvas);
	  			}
			});
    	}
    </script>

  </head>
  <body>
  	<div class="container">
    	<div class="row">
    		<div class="col-xs-12 col-sm-8 header">
    			<h1>VK Popuper<br>
    			<small>Создайте всплывающее окно в стиле VK со своим текстом!</small></h1>
    		</div>
    	</div>

    	<div class="row">
    		<div class="col-xs-12">
    			<p class="h2 description description">Создайте своё всплывающее окошко:</p>
    			<div class="row create-message">
		    		<div class="col-xs-12 col-sm-6">

		    			<div class="input-group top-text">
						  <span class="input-group-addon">Заголовок:</span>
						  <input type="text" id="message_header_input" class="form-control" aria-label="Введите заголовок для всплывающего окошка">
						</div>

						<div class="input-group sender-name">
						  <span class="input-group-addon">Имя отправителя:</span>
						  <input type="text" id="message_sender_input" class="form-control" aria-label="Введите имя отправителя">
						</div>

						<div class="input-group main-text">
						  <span class="input-group-addon">Основной текст:</span>
						  <input type="text" id="message_text_input"class="form-control" aria-label="Введите основной текст всплывающего окошка">
						</div>

						<button type="button" class="btn btn-default" style="float:right;" onclick="SaveImage()">
						  <span class="glyphicon glyphicon-download"  aria-hidden="true"></span> Сохранить
						</button>

		    		</div>
		    		<div class="col-xs-12 col-sm-6">
		    			<div class="row">
				    		<div class="col-xs-12">
				    			<p class="italic">Превью:</p>
				    			<div id="message_body">
				    					<div id="messages_wrap" class="fixed" style="bottom: 0px;">
					    					<div class="message_baloon_wrap" style="visibility: visible;">
					    						<div class="message_baloon clear_fix" style="opacity: 1;">
					    							<div class="message_baloon_head clear_fix">
					    								<div class="message_baloon_title fl_l" id="message_header">Ваша запись понравилась</div>
					    								<div class="message_close_wrap fl_r">
					    									<a class="message_close" title="Закрыть" href=""></a>
					    								</div>
					    							</div>
					    							<div class="message_baloon_body">
					    								<table cellpadding="0" cellspacing="0" width="100%">
					    									<tbody>
					    										<tr>
					    											<td class="message_image_wrap">
					    												<div class="message_image_wrap">
					    													<a>
					    														<img src="http://cs7003.userapi.com/v7003685/1ddd/jZ8LZcwYN20.jpg" class="message_image" id="sender_image">
					    													</a>
					    												</div>
					    											</td>
					    											<td class="message_baloon_msg">
					    												<div class="message_baloon_msg wrapped" style="width: 180px;">
					    													<a class="mem_link" id="message_sender">Павлу Дурову</a> <span id="message_text">понравилась Ваша запись.</span>
					    												</div>
					    											</td>
					    										</tr>
				    										</tbody>
			    										</table>
													</div>
												</div>
											</div>
										</div>
				    			</div>
				    		</div>
				    		<div class="col-xs-12">
				    			<div id="image-result">

				    			</div>
				    		</div>
			    		</div>
		    		</div>

		    	</div>
			</div>
		</div>

		<div class="row footer hidden-xs sm-visible">
			<div class="col-xs-12 col-sm-8 footer_text">
				<p class="h1">Автор: <a href="https://vk.com/id108680934">вот этот чувак</a>, рассказывайте друзьям, подписывайтесь, <span class="deleted">дарите ему деньги и кокаин</span> занимайтесь только безопасным сексом, любите друг друга и будьте здоровы.</p>
			</div>		
			<div class="col-xs-12 col-sm-4 qr_code">
				<div class="row">
					<div class="col-xs-12 col-lg-6">
						<div class="qr_img"></div>
					</div>
					<div class="col-xs-12 col-lg-6">
						<p class="italic" >Вы можете быстро перейти на этот сайт с мобильного устройства (я не знаю, зачем это нужно, но так, вроде как, модно).</p>
					</div>
				</div>				
			</div>
		</div>
		<div class="row footer-mobile xs-visible hidden-sm hidden-lg hidden-md">
			<div class="col-xs-12">
				<p>Автор: <a href="https://vk.com/id108680934">вот этот чувак</a>, рассказывайте друзьям, подписывайтесь, <span class="deleted">дарите ему деньги и кокаин</span> занимайтесь только безопасным сексом, любите друг друга и будьте здоровы.</p>
			</div>
		</div>

	    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	    <!-- Include all compiled plugins (below), or include individual files as needed -->
	    <script src="js/bootstrap.min.js"></script>

	    <script>
		$(document).ready(function(){
		    jQuery('#message_header_input').on('input propertychange paste', function() {
			    $("#message_header").text($(this).val());
			    if( !$(this).val()) {
			    	$("#message_header").text("Ваша запись понравилась");
			    }
			});
			jQuery('#message_sender_input').on('input propertychange paste', function() {
			    $("#message_sender").text($(this).val());
			    if( !$(this).val()) {
		    		$("#message_sender").text("Павлу Дурову");
			    }
			});
			jQuery('#message_text_input').on('input propertychange paste', function() {
			    $("#message_text").text($(this).val());
			    if( !$(this).val()) {
			    	$("#message_text").text("понравилась Ваша запись.");
			    }
			});
		});
		</script>
  </body>
</html>